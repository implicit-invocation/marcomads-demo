(this.webpackJsonpmarcomads=this.webpackJsonpmarcomads||[]).push([[0],{28:function(e,t,n){e.exports=n(46)},33:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(15),c=n.n(i),l=(n(33),n(10)),o=n(2),u=n(4),s=n.n(u),h=n(7),p=n(8);var f=function(e){var t=e.onInit,n=e.onClick,i=e.onResize,c=Object(p.a)(e,["onInit","onClick","onResize"]),l=Object(r.useRef)(null),o=Object(r.useCallback)((function(){var e=l.current;!function(e){var t=e.clientWidth,n=e.clientHeight;e.width===t&&e.height===n||(e.width=t,e.height=n)}(e),i&&i(e.width,e.height)}),[i]),u=Object(r.useCallback)((function(e){var t=l.current.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top;n&&n(r,a)}),[n]),s=Object(r.useMemo)((function(){return"ontouchstart"in window?{onTouchStart:u}:{onClick:u}}),[u]);return Object(r.useEffect)((function(){var e=l.current;o(),window.addEventListener("resize",o);var n=t&&t(e.getContext("webgl"),e.width,e.height);return function(){n&&Promise.resolve(n).then((function(e){return e()})),window.removeEventListener("resize",o)}}),[o,t]),console.log(s),a.a.createElement("canvas",Object.assign({},s,{ref:l},c))},g=n(16),m=n.n(g),d=n(1),v=function(e,t,n,r,a,i,c){var l=Object(o.a)(t,3),u=l[0],s=l[1],h=l[2];return u-=r,s=c-s-1,s-=a,e[0]=2*u/i-1,e[1]=2*s/c-1,e[2]=2*h-1,function(e,t,n){var r=Object(o.a)(t,3),a=r[0],i=r[1],c=r[2],l=n,u=l[0],s=l[1],h=l[2],p=l[3],f=l[4],g=l[5],m=l[6],d=l[7],v=l[8],b=l[9],w=l[10],k=l[11],y=l[12],x=l[13],O=l[14],E=1/(a*p+i*d+c*k+l[15]);return e[0]=(a*u+i*f+c*v+y)*E,e[1]=(a*s+i*g+c*b+x)*E,e[2]=(a*h+i*m+c*w+O)*E,e}(e,e,n)},b=function(e,t,n,r){var a=d.a.create();d.a.ortho(a,0,e,t,0,0,1);var i=d.a.create();d.a.invert(i,a);var c=d.a.create(),l=[0,0,0],o=[],u=[],s=[],h=[];return{combined:a,setMatrix:function(e){d.a.copy(a,e),d.a.invert(i,a)},unprojectVector2:function(e,t){l[0]=t[0],l[1]=t[1],l[2]=0,v(l,l,i,0,0,n,r),e[0]=l[0],e[1]=l[1]},resize:function(e,t){d.a.ortho(a,0,e,t,0,0,1),d.a.invert(i,a)},translate:function(e,t){h.length=0,h[0]=e,h[1]=t,h[2]=0,d.a.translate(a,a,h),d.a.invert(i,a)},scale:function(e,t,n){o.length=0,o[0]=e,o[1]=t,o[2]=0,u.length=0,u[0]=n,u[1]=n,u[2]=1,s.length=0,s[0]=-e,s[1]=-t,s[2]=0,d.a.identity(c),d.a.translate(c,c,o),d.a.scale(c,c,u),d.a.translate(c,c,s),d.a.mul(a,a,c),d.a.invert(i,a)}}},w=n(9),k=n.n(w),y=function(e,t,n){return new Promise((function(n){var r=new Image;r.src=t,r.onload=function(){var t=new k.a(e,{image:r});t.setFilter(k.a.Filter.LINEAR,k.a.Filter.LINEAR,!1),n(t)}}))},x=n(17),O=n(18),E=function(){function e(t,n,r,a,i,c,l,o){Object(x.a)(this,e),l&&o||(l=1/t.width,o=1/t.height);var u=n*l,s=r*o,h=(n+a)*l,p=(r+i)*o;for(var f in this.texture=t,this.x=n,this.y=r,this.width=a,this.height=i,this.u=u,this.v=s,this.u2=h,this.v2=p,c)this[f]=c[f]}return Object(O.a)(e,[{key:"draw",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;e.draw(this.texture,t,n,r,a,i,c,l,o,u,this.u,this.v,this.u2,this.v2)}}]),e}();function j(e,t){for(var n=e.split("/"),r=t.split("/"),a=[],i=0,c=n.length;i<c;i++)if(".."===n[i])a.pop();else{if("."===n[i])continue;a.push(n[i])}for(var l=0,o=r.length;l<o;l++)if(".."===r[l])a.pop();else{if("."===r[l])continue;a.push(r[l])}return a.join("/")}var U=0,C=1,I=function(){var e=Object(h.a)(s.a.mark((function e(t,n){var r,a,i,c,l,u,h,p,f,g,m,d,v,b,w,k,x,O,I,M,P,R,N,D,K,L,S,F,W,z,B,T,H,A,X,Y,J,_,q,V,$;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n).then((function(e){return e.text()}));case 2:r=e.sent,a=[],i=[],l=r.split("\n"),u=0;case 7:if(void 0!==(p=l[u])){e.next=11;break}return e.abrupt("break",15);case 11:0===p.trim().length?c=null:null===c?(f=j(n,"../".concat(p)),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),g=parseInt(h[0],10),m=parseInt(h[1],10),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),d=h[0],p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),v=h,b=Object(o.a)(v,2),w=b[0],k=b[1],p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),x=h[0],O=U,I=U,"x"===x?O=C:"y"===x?I=C:"xy"===x&&(O=C,I=C),c={file:f,width:g,height:m,format:d,mipMaps:"Nearest"!==w&&"Linear"!==w,min:w,max:k,direction:x,repeatX:O,repeatY:I},a.push(c)):(M=p,p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),P="true"===h[0],p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),R=parseInt(h[0],10),N=parseInt(h[1],10),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),D=parseInt(h[0],10),K=parseInt(h[1],10),L={name:M,rotate:P,left:R,top:N,width:D,height:K,page:c},p=l[++u],4===(h=p.split(":")[1].split(",").map((function(e){return e.trim()}))).length&&(L.splits=h.map((function(e){return parseInt(e,10)})),p=l[++u],4===(h=p.split(":")[1].split(",").map((function(e){return e.trim()}))).length&&(L.pads=h.map((function(e){return parseInt(e,10)})),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})))),L.originalWidth=parseInt(h[0],10),L.originalHeight=parseInt(h[1],10),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),L.offsetX=parseInt(h[0],10),L.offsetY=parseInt(h[1],10),p=l[++u],h=p.split(":")[1].split(",").map((function(e){return e.trim()})),L.index=parseInt(h[0],10),i.push(L)),u++,e.next=7;break;case 15:S=0,F=a;case 16:if(!(S<F.length)){e.next=26;break}return W=F[S],e.next=20,y(t,W.file);case 20:W.texture=e.sent,W.invTexWidth=1/W.texture.width,W.invTexHeight=1/W.texture.height;case 23:S++,e.next=16;break;case 26:for(z=[],B=0,T=i;B<T.length;B++)H=T[B],A=H.left,X=H.top,Y=H.rotate?H.height:H.width,J=H.rotate?H.width:H.height,_=H.page,q=_.texture,V=_.invTexWidth,$=_.invTexHeight,z.push(new E(q,A,X,Y,J,H,V,$));return e.abrupt("return",{getRegions:function(){return z},findRegion:function(e,t){for(var n=0;n<z.length;n++){var r=z[n];if(r.name===e&&(void 0===t||r.index===t))return r}return null},findRegions:function(e){return z.filter((function(t){return t.name===e})).sort((function(e,t){return e.index-t.index}))}});case 29:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=0,P=1,R=2,N=3,D=4,K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{getKeyFrame:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,a=Math.floor(n/e);switch(r){case M:a=Math.min(t.length-1,a);break;case P:a%=t.length;break;case R:(a%=2*t.length-2)>=t.length&&(a=t.length-2-(a-t.length));break;case N:a=Math.max(t.length-a-1,0);break;case D:a%=t.length,a=t.length-a-1}return t[a]}}},L=n(19),S=function(e){var t=e.config,n=void 0===t?{characterUrl:"/flappy.atlas",characterKey:"bluebird",backgroundUrl:"/background-day.png",sign01Url:"/sign01.png",sign02Url:"/sign02.png"}:t,i=Object(p.a)(e,["config"]),c=Object(r.useMemo)((function(){return new L.EventEmitter}),[]),l=Object(r.useCallback)((function(e,t){return c.emit("canvasClick",e,t)}),[c]),o=Object(r.useCallback)(function(){var e=Object(h.a)(s.a.mark((function e(t,r,a){var i,l,o,u,h,p,f,g,d,v,w,k,x,O,E,j,U,C,M,R,N,D,L,S,F,W;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=m()(t,{size:1e3}),u=b(l=10,o=l*a/r,r,a),e.next=6,y(t,n.backgroundUrl);case 6:return h=e.sent,e.next=9,y(t,"/base.png");case 9:return p=e.sent,e.next=12,y(t,"/pipe-green.png");case 12:return f=e.sent,e.next=15,I(t,n.characterUrl);case 15:return g=e.sent,e.next=18,y(t,n.sign01Url);case 18:return d=e.sent,e.next=21,y(t,n.sign02Url);case 21:return v=e.sent,w=K(.1,g.findRegions(n.characterKey)),t.viewport(0,0,r,a),1.2,.288/.34,k=0,20,60,x=-Math.PI/6,7,O=l,E=Math.min(l/3,o/5),2.4,768/52,j=.288/.34*5,U=20,C=o/2,M=l,R=function(){M=l,C=o/2,U=0,D[0]=Math.random()*(o-3*E)+E,D[1]=Math.random()*(o-3*E)+E},c.addListener("canvasClick",(function(e,t){N&&(N=!1,R()),U=-20})),N=!1,D=[Math.random()*(o-3*E)+E,Math.random()*(o-3*E)+E],L=[!1,!0],S=function(e){if(t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),!N){U+=60*e,U=Math.min(U,20),C+=U*e,(M-=7*e)<=-l&&(M=0,D[0]=D[1],D[1]=Math.random()*(o-3*E)+E,L[0]=L[1],L[1]=Math.random()>.7&&D[1]>l/2),k+=e,C>o-E&&(N=!0);var n=M+.75*O,r=l/4;if(r<=n+1.2&&r>=n-1.2){var a=D[0];N=C>a+j/2||C<a-j/2}}i.setProjection(u.combined),i.begin(),i.draw(h,0,0,l,o);for(var c=0;c<D.length;c++)i.draw(f,M+.75*O+O*c-1.2,D[c]+j/2,2.4,768/52),i.draw(f,M+.75*O+O*c-1.2,D[c]-j/2-768/52,2.4,768/52,1.2,768/52/2,Math.PI),L[c]&&i.draw(v,M+.75*O+O*c-1.2-6,o/20,6,2.4);M>0&&i.draw(p,M-O,o-E,O,E),M-O+2*O/3+2.4>0&&i.draw(d,M-O+2*O/3-2.4,o-E-1.2*3,4.8,1.2*3),i.draw(p,M,o-E,O,E),i.draw(p,M+O,o-E,O,E),w.getKeyFrame(k,P).draw(i,l/4-.6,C-.288/.34/2,1.2,.288/.34,.6,.288/.34/2,U<0?x:Math.PI/2*U/20),i.end()},F=!0,W=Date.now(),function e(){var t=Date.now()-W;S(t/1e3),W=Date.now(),F&&requestAnimationFrame(e)}(),e.abrupt("return",(function(){return F=!1}));case 49:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),[c,n]);return a.a.createElement(f,Object.assign({},i,{onInit:o,onClick:l}))};n(45);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e){var t=Object(r.useState)(e),n=Object(o.a)(t,2),a=n[0],i=n[1];return[a,function(e,t){return i(W({},a,Object(l.a)({},e,t)))}]};var B=function(){var e=z({characterUrl:"/flappy.atlas",characterKey:"bluebird",backgroundUrl:"/background-day.png",sign01Url:"/sign01.png",sign02Url:"/sign02.png"}),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(r.useState)(n),l=Object(o.a)(c,2),u=l[0],s=l[1];return a.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"row",flexWrap:"wrap"}},a.a.createElement(S,{config:u,style:{width:"45vh",height:"90vh",border:"thin solid #ccc"}}),a.a.createElement("div",{style:{alignSelf:"self-start",padding:50,minWidth:"20vw"}},a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),s(W({},n))}},a.a.createElement("div",null,a.a.createElement("label",null,"Background URL:"),a.a.createElement("input",{type:"text",value:n.backgroundUrl,onChange:function(e){return i("backgroundUrl",e.target.value)}}),a.a.createElement("div",{className:"panel"},a.a.createElement("button",{className:"link",onClick:function(e){return i("backgroundUrl","/background-day.png")}},"Use day"),a.a.createElement("button",{className:"link",onClick:function(e){return i("backgroundUrl","/background-night.png")}},"Use night"),a.a.createElement("button",{className:"link",onClick:function(e){return i("backgroundUrl","/paris.jpg")}},"Use Paris"))),a.a.createElement("div",null,a.a.createElement("label",null,"Character URL:"),a.a.createElement("input",{type:"text",value:n.characterUrl,onChange:function(e){return i("characterUrl",e.target.value)}})),a.a.createElement("div",null,a.a.createElement("label",null,"Character key:"),a.a.createElement("input",{type:"text",value:n.characterKey,onChange:function(e){return i("characterKey",e.target.value)}}),a.a.createElement("div",{className:"panel"},a.a.createElement("button",{className:"link",onClick:function(e){return i("characterKey","redbird")}},"Use red"),a.a.createElement("button",{className:"link",onClick:function(e){return i("characterKey","bluebird")}},"Use blue"))),a.a.createElement("div",null,a.a.createElement("label",null,"Sign 01"),a.a.createElement("input",{type:"text",value:n.sign01Url,onChange:function(e){return i("sign01Url",e.target.value)}})),a.a.createElement("div",null,a.a.createElement("label",null,"Sign 02:"),a.a.createElement("input",{type:"text",value:n.sign02Url,onChange:function(e){return i("sign02Url",e.target.value)}})),a.a.createElement("button",null,"Preview"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.a741f001.chunk.js.map